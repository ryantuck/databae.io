<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="generator" content="Hugo 0.18.1" />
	
	<title>gspread - helpful programming nuggets.</title>

	
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="http://databae.io/css/bootstrap.min.css" rel="stylesheet">
	<link href="http://databae.io/css/strange-case.css" rel="stylesheet">
	

	
	
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body class="scheme-slate">


	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-4 col-md-3 col-lg-3 sidebar">

			
	<div class="sidebar-content">

		<a href="http://databae.io"><h1>databae.io</h1></a>
		<p>helpful programming nuggets.</p>

		

		<ul class="sidebar-menus">
			
		</ul>

		<div class="sidebar-recent hidden-xs">
			<p>posts</p>
			<ul>
                
				<li><a href="http://databae.io/post/dumb-birthdays/">dumb birthdays</a></li>
				
				<li><a href="http://databae.io/post/gspread/">gspread</a></li>
				
				<li><a href="http://databae.io/post/information-schema/">information schema</a></li>
				
				<li><a href="http://databae.io/post/n-choose-k/">n choose k</a></li>
				
				<li><a href="http://databae.io/post/postgres-admin-queries/">postgres admin queries</a></li>
				
				<li><a href="http://databae.io/post/postgres-json-queries/">postgres json queries</a></li>
				
				<li><a href="http://databae.io/post/psql/">psql</a></li>
				
				<li><a href="http://databae.io/post/sed/">sed</a></li>
				
				<li><a href="http://databae.io/post/sql-basics/">sql basics</a></li>
				
				<li><a href="http://databae.io/post/sql-to-csv/">sql to csv</a></li>
				
				<li><a href="http://databae.io/post/sqlalchemy-stored-procs/">sqlalchemy and stored procs</a></li>
				
				<li><a href="http://databae.io/post/ssh-keygen/">ssh keygen</a></li>
				
				<li><a href="http://databae.io/post/todo-cli/">todo cli</a></li>
				
				<li><a href="http://databae.io/post/web-cli/">web cli</a></li>
				
			</ul>
		</div>

        <div style="text-align:right">
            <span><a target="_blank" href="https://github.com/ryantuck/databae.io"><i class="fa fa-github fa-2x"></i></a></span>
        </div>
	</div>


			</div>
			<div class="col-sm-7 col-sm-offset-4 col-md-6 col-md-offset-3 col-lg-5 col-lg-offset-3 content">

				<div class="post">

					<div class="post-heading">
						<h1>gspread</h1>
						<span class="post-date"><a href="http://databae.io/post/gspread/"># 14 Feb 2017</a></span>
					</div>

					

<p>So you wanna pull some google sheets data into python?</p>

<p><code>gspread</code> is a really handy python module for doing just
that. There&rsquo;s some authentication setup involved but it&rsquo;s
pretty straightforward.</p>

<p>Once you&rsquo;ve authenticated, you can check out the <code>readme</code>
for basic usage for reading/writing to and from sheets over
at <a href="https://github.com/burnash/gspread">https://github.com/burnash/gspread</a></p>

<h2 id="setup">setup</h2>

<h3 id="creds">creds</h3>

<p>You need to set up your credentials so you can access your
google sheet. Fortunately this is pretty straightforward.</p>

<p>And the <code>gspread</code> documentation also has these instructions
<a href="http://gspread.readthedocs.io/en/latest/oauth2.html">documented
here</a>.</p>

<p>I followed the instructions
<a href="https://developers.google.com/identity/protocols/application-default-credentials?authuser=1">here</a>
but the <strong>tl;dr</strong> is that you need to head over to the <a href="https://console.developers.google.com/projectselector/apis/credentials">API
Console
Credentials</a>
section of the google developers portal.</p>

<ol>
<li>Select &lsquo;create a project&rsquo;. Give it a name. Yatta yatta
yatta.</li>
<li>Select &lsquo;create credentials&rsquo; &gt; &lsquo;Service Account Key&rsquo;. I
think this is the easiest. It&rsquo;ll basically give you a
file to download.</li>
<li>Select &lsquo;new service account&rsquo; and give it the &lsquo;Owner&rsquo;
role, along with some name.</li>
<li>Select <code>json</code> key type.</li>
<li>Hit &lsquo;create&rsquo;. This should download a <code>.json</code> file to your
computer.</li>
<li>Move that credentials file somewhere (let&rsquo;s say
<code>~/Desktop</code>).</li>
</ol>

<h3 id="share-a-sheet">share a sheet</h3>

<p>You&rsquo;ll need to share your sheet with the service account you
just created. From the credentials page, you should see a
link for &lsquo;Manage Service Accounts&rsquo;. Check that out and you
should see your service account ID for the one you just
created. It&rsquo;ll look something like</p>

<pre><code>rt-testing@123456.iam.gserviceaccount.com
</code></pre>

<p>Share your sheet with that account. Boom.</p>

<h2 id="code">code</h2>

<h3 id="install-stuff">install stuff</h3>

<pre><code>pip install gspread oauth2client PyOpenSSL
</code></pre>

<h3 id="pull-sheet">pull sheet</h3>

<p>Now pull it! <code>gspread</code> has great documentation for using the
module but I&rsquo;ve found setup to be a big pain in the ass, so
I hope this post helps.</p>

<pre><code class="language-python">import gspread
from oauth2client.service_account import ServiceAccountCredentials

# that filename path is the creds file you downloaded
credentials = ServiceAccountCredentials.from_json_keyfile_name(
    filename='/Users/ryan/Desktop/rt-testing-12345678.json',
    scopes='https://spreadsheets.google.com/feeds',
)

gc = gspread.authorize(credentials)

worksheet = gc.open('My Workbook Title').worksheet('some sheet title')

records = worksheet.get_all_records()
</code></pre>


				</div>

			</div>
			<div class="col-sm-1 col-md-3 col-md-4">
			</div>
		</div>
	</div>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<script src="http://databae.io/js/bootstrap.min.js"></script>

</body>
</html>