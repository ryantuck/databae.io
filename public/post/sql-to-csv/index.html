<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="generator" content="Hugo 0.18.1" />
	
	<title>sql to csv - helpful programming nuggets.</title>

	
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="http://databae.io/css/bootstrap.min.css" rel="stylesheet">
	<link href="http://databae.io/css/strange-case.css" rel="stylesheet">
	

	
	
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body class="scheme-slate">


	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-4 col-md-3 col-lg-3 sidebar">

			
	<div class="sidebar-content">

		<a href="http://databae.io"><h1>databae.io</h1></a>
		<p>helpful programming nuggets.</p>

		

		<ul class="sidebar-menus">
			
		</ul>

		<div class="sidebar-recent hidden-xs">
			<p>posts</p>
			<ul>
                
				<li><a href="http://databae.io/post/dumb-birthdays/">dumb birthdays</a></li>
				
				<li><a href="http://databae.io/post/gspread/">gspread</a></li>
				
				<li><a href="http://databae.io/post/information-schema/">information schema</a></li>
				
				<li><a href="http://databae.io/post/n-choose-k/">n choose k</a></li>
				
				<li><a href="http://databae.io/post/postgres-admin-queries/">postgres admin queries</a></li>
				
				<li><a href="http://databae.io/post/postgres-json-queries/">postgres json queries</a></li>
				
				<li><a href="http://databae.io/post/psql/">psql</a></li>
				
				<li><a href="http://databae.io/post/sed/">sed</a></li>
				
				<li><a href="http://databae.io/post/sql-basics/">sql basics</a></li>
				
				<li><a href="http://databae.io/post/sql-to-csv/">sql to csv</a></li>
				
				<li><a href="http://databae.io/post/sqlalchemy-stored-procs/">sqlalchemy and stored procs</a></li>
				
				<li><a href="http://databae.io/post/ssh-keygen/">ssh keygen</a></li>
				
				<li><a href="http://databae.io/post/todo-cli/">todo cli</a></li>
				
				<li><a href="http://databae.io/post/web-cli/">web cli</a></li>
				
			</ul>
		</div>

        <div style="text-align:right">
            <span><a target="_blank" href="https://github.com/ryantuck/databae.io"><i class="fa fa-github fa-2x"></i></a></span>
        </div>
	</div>


			</div>
			<div class="col-sm-7 col-sm-offset-4 col-md-6 col-md-offset-3 col-lg-5 col-lg-offset-3 content">

				<div class="post">

					<div class="post-heading">
						<h1>sql to csv</h1>
						<span class="post-date"><a href="http://databae.io/post/sql-to-csv/"># 12 Feb 2017</a></span>
					</div>

					<p>Had a hell of a time trying to get the results of a <code>.sql</code>
file to output to a csv. Here&rsquo;s what I had to do:</p>

<pre><code>#!/bin/bash

# executes a .sql file and outputs results to a .csv
# ./sql_to_csv.sh my_query.sql output.csv

CONN=&quot;psql -U my_user -d my_db&quot;

# remove all semicolons and comments
# replace newlines with spaces
QUERY=&quot;$(sed 's/;//g;/^--/ d;s/--.*//g;' $1 | tr '\n' ' ')&quot;
echo &quot;$QUERY&quot;

echo &quot;\\copy ($QUERY) to '$2' with csv header&quot; | $CONN &gt; /dev/null
</code></pre>

<p>So to make it work:</p>

<pre><code>./sql_to_csv.sh my_query.sql output.csv
</code></pre>


				</div>

			</div>
			<div class="col-sm-1 col-md-3 col-md-4">
			</div>
		</div>
	</div>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<script src="http://databae.io/js/bootstrap.min.js"></script>

</body>
</html>